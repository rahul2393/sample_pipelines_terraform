language: go

go:
  - 1.9

resources:
  - name: integration-aws
    type: integration
    integration: integration-aws
  - name: repo-tfScripts
    type: gitRepo
    integration: github	   #REPLACE THIS WITH YOUR GITHUB INTEGRATION
    pointer:
      sourceName: rahul2393/sample_pipelines_terraform  #REPLACE nanishas WITH YOUR org name
      branch: master
  - name: params-tfScripts
    type: params
    version:
      params:
        REGION: "us-east-1"

build:
  ci:
    - echo $integration-aws_INTEGRATION_ACCESSKEY
    - FILE_NAME=terraform_0.7.4_linux_amd64.zip
    - sudo apt-get update && apt-get install wget jq unzip
    - wget https://releases.hashicorp.com/terraform/0.7.4/$FILE_NAME
    - unzip $FILE_NAME -d $(pwd)
    - export PATH=$PATH:/build
    - export AWS_ACCESS_KEY_ID=AKIAJTSI3ZJNZUENN6CQ
    - export AWS_SECRET_ACCESS_KEY=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
    - export AWS_DEFAULT_REGION="ap-south-1"
    - terraform -v
    - terraform init
    - terraform plan
    - terraform apply -auto-approve