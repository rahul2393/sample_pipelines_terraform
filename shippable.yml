language: go

go:
  - 1.9

resources:
  - name: integration-aws
    type: integration
    integration: integration-aws
  - name: repo-tfScripts
    type: gitRepo
    integration: github	   #REPLACE THIS WITH YOUR GITHUB INTEGRATION
    pointer:
      sourceName: rahul2393/sample_pipelines_terraform  #REPLACE nanishas WITH YOUR org name
      branch: master
  - name: params-tfScripts
    type: params
    version:
      params:
        REGION: "us-east-1"

build:
  ci:
    - echo $integration-aws_INTEGRATION_ACCESSKEY
    - export AWS_ACCESS_KEY_ID=AKIAIQRM4YV47TWGYY7Q
    - export AWS_SECRET_ACCESS_KEY=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
    - export AWS_DEFAULT_REGION="ap-south-1"
    - sed -i "s/<AWS_ACCESS_KEY_ID>/$AWS_ACCESS_KEY_ID/g" ./terraform.tf
    - sed -i "s/<REGION>/AWS_DEFAULT_REGION/g" ./terraform.tf
    - sed -i "s/<AWS_SECRET_KEY>/$AWS_SECRET_ACCESS_KEY/g" ./terraform.tf
    - echo $PWD
    - ls -la
    - docker run -v ${PWD}:${PWD} -w ${PWD} agrawalveeru/terra shell